{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Packetflow Homelab Documentation","text":""},{"location":"#welcome","title":"Welcome","text":"<p>Welcome to the documentation for the Packetflow Homelab. This project serves as a practical testing ground for network engineering concepts, specifically focusing on CCNA certification topics and IPv6 implementation. It's subject to many changes and should not be considered a production environment.  </p>"},{"location":"#lab-overview","title":"Lab Overview","text":"<ul> <li>Primary Router: Fortinet FortiGate 40F (handling Routing, Security, SD-WAN).  </li> <li>Core Switching: Ubiquiti EdgeSwitch 8 PoE (handling VLANs, PoE).  </li> <li>Wireless/Access: MikroTik hAP ac lite (handling WiFi, Bridge Filtering).  </li> </ul>"},{"location":"#documentation-structure","title":"Documentation Structure","text":"<p>The documentation is currently focused on networking, and has been structured into sections within the Network module:</p>"},{"location":"#1-physical-layout","title":"1. Physical Layout","text":"<p>Detailed inventory of all physical devices, cabling maps, and the physical topology showing how the ISP Modem, FortiGate, and downstream switches connect.</p>"},{"location":"#2-logical-layout","title":"2. Logical Layout","text":"<p>Defines the Logical Topology.</p> <ul> <li>VLANs: Segmentation for Default, Guest, Servers, DMZ, and Management.  </li> <li>IPv6 Strategy: Explains the decision to use Unique Local Addressing (ULA) (<code>fdb1:6575:ad8a::/48</code>) due to ISP (modem) constraints.</li> <li>WAN/SD-WAN: Configuration of the <code>virtual-wan-link</code> interface.</li> </ul>"},{"location":"#3-device-decisions","title":"3. Device Decisions","text":"<p>Covers routing, switching, and configuration standards.</p> <ul> <li>Switching: 802.1Q Trunks, Native VLAN security, and Bridge VLAN Filtering on MikroTik.  </li> <li>Routing: Inter-VLAN routing and IPv6 Router Advertisements (RA).</li> <li>Standards: Interface configuration templates and naming conventions.</li> </ul>"},{"location":"#4-security","title":"4. Security","text":"<p>Documents the Security policies used.  </p> <ul> <li>Zones: Trusted vs Untrusted vs Management.  </li> <li>Policies: Specific firewall rules allowing traffic while blocking inter-VLAN access by default.  </li> </ul>"},{"location":"#5-wireless","title":"5. Wireless","text":"<p>Design decisions for the <code>Declerck-Cardon</code> SSID, frequency planning, and security standards. </p>"},{"location":"#future-plans","title":"Future Plans","text":"<ul> <li>Add another hAP ac lite to act as second switch.</li> <li>Add another router to act as remote/branch office router.</li> <li>Replace my current Telenet modem with a new one to support IPv6 Global Unicast Addressing in all VLANs.     So far i've managed to get it working in one VLAN.  </li> <li>Setup a DNS server with dynamic DNS.</li> </ul>"},{"location":"#disclaimer","title":"Disclaimer","text":"<p>The documentation is written with the help of Google Gemini. The decisions made are based on my own knowledge and experience. </p>"},{"location":"status/","title":"System Status &amp; Incident Log","text":"<p>Current Status: No outages</p> <p>This is currently manually updated.</p>"},{"location":"status/#incident-history","title":"Incident History","text":""},{"location":"status/#2026","title":"2026","text":""},{"location":"status/#february-10-2026-ipv4-connectivity-loss","title":"February 10, 2026 - IPv4 Connectivity Loss","text":"<p>Outage: Partial Internet Loss</p> <ul> <li>Time: 04:00 - 15:15 CET</li> <li>Issue     fw01 failed to acquire a WAN IPv4 address from the ISP modem.     Local network devices lost access to IPv4 internet services.     Local IPv6 and IPv4 traffic remained operational.  </li> <li>Impact <ul> <li>Users: Medium. Most client devices automatically switched to the telenet modem wifi.</li> <li>Services: No services connected, all LAN traffic </li> <li>Unaffected: Local LAN traffic and IPv6-enabled sites (Google/YouTube).  </li> </ul> </li> <li>Root Cause     The ISP Modem DHCP service hung or entered a stale state, refusing to renew the lease for the firewall's WAN interface.  </li> <li>Resolution     Physical power cycle of the ISP Modem. Connectivity restored immediately upon reboot.  </li> </ul>"},{"location":"01_network/01_physical/","title":"Physical Layout","text":""},{"location":"01_network/01_physical/#1-site-tiers","title":"1. Site Tiers","text":"<p>To standardize network deployments, sites are categorized into tiers based on their function and requirements.</p> Tier Description Requirements Home Office Primary residence and main lab environment. High availability, 10GbE core, experimental hardware. Branch Office Remote locations (e.g., family homes connected via VPN). Low maintenance, stable connectivity, remote management. Mobile Roaming devices connecting via VPN. Secure access to internal resources."},{"location":"01_network/01_physical/#2-hardware-inventory-bom","title":"2. Hardware Inventory (BOM)","text":"<p>Current hardware deployed in the Home Office tier.</p> Device Role Make / Model Hostname Description / Notes Router / Firewall Fortinet FortiGate 40F <code>FW01</code> Main internet gateway and security appliance. Core Switch Ubiquiti EdgeSwitch 8 PoE <code>ALS01</code> Managed L2 switch providing PoE to APs and connectivity to servers. Access Point MikroTik hAP ac lite <code>AP01</code> Dual-concurrent Access Point. Used for learning MikroTik RouterOS. Compute Generic Servers Various Hypervisors and storage servers. <p>Note: All hosts are part of the <code>lab.internal.packetflow.be</code> domain.</p>"},{"location":"01_network/01_physical/#3-physical-topology","title":"3. Physical Topology","text":"<p>The network centers around a \"Core Rack\" configuration where the FortiGate handles WAN and the EdgeSwitch handles internal distribution.</p> <p>[Image Placeholder: Physical Topology Diagram] (Include rack diagram here)</p>"},{"location":"01_network/01_physical/#4-cabling-port-map","title":"4. Cabling &amp; Port Map","text":""},{"location":"01_network/01_physical/#fortigate-40f-fw01","title":"FortiGate 40F (<code>FW01</code>)","text":"Port Type Connected Device Notes WAN RJ45 ISP Modem Public IP via DHCP/PPPoE 1 RJ45 AP01 HAP AC Lite currently used as AP 2 RJ45 ALS01 Main Trunk Link (Carries all VLANs) 3 RJ45 Reserved Emergency Management / Direct Access"},{"location":"01_network/01_physical/#ubiquiti-edgeswitch-8-poe-als01","title":"Ubiquiti EdgeSwitch 8 PoE (<code>ALS01</code>)","text":"Port Profile Connected Device PoE Mode 1 Trunk uplink to FW01 POE+ (0W) 2-8 Access/Trunk Servers / IoT As needed"},{"location":"01_network/01_physical/#mikrotik-hap-ac-lite-ap01","title":"MikroTik hAP ac lite (<code>AP01</code>)","text":"<p>Radio Configuration: - wlan1 (2.4GHz): Legacy/IoT devices - wlan2 (5GHz): High-speed clients</p>"},{"location":"01_network/02_logical/","title":"Logical Layout","text":""},{"location":"01_network/02_logical/#1-business-drivers-goals","title":"1. Business Drivers &amp; Goals","text":"<p>The Packetflow Homelab network typically serves two primary functions: 1.  Production Home Network: Providing stable, high-speed internet access for daily use (Working from Home, Streaming, Gaming). 2.  Experimental Lab: A playground for learning networking concepts (IPv6, BGP, SD-WAN, Segmentation) without disrupting our ability to watch netflix.</p> <p>Key Goals: - Strict Segmentation: Isolating \"Home\" traffic from \"Guest\" and \"Server\" traffic. - IPv6 First: Implementing a dual-stack network with a focus on IPv6. - Vendor Diversity: Gaining proficiency with Fortinet, Ubiquiti, and MikroTik ecosystems.</p>"},{"location":"01_network/02_logical/#2-global-network-design","title":"2. Global Network Design","text":"<p>The network architecture is designed to support a multi-site topology, although currently only the primary site is active.</p> <ul> <li>Home Office (HQ): The primary site hosting the core infrastructure (<code>10.10.0.0/16</code>).</li> <li>Branch Office (Remote): A planned remote site for simulating site-to-site VPNs (<code>10.20.0.0/16</code>).</li> <li>Cloud/VPS: External resources connected via VPN (e.g., VPS for off-site backups/monitoring).</li> </ul>"},{"location":"01_network/02_logical/#3-naming-conventions","title":"3. Naming Conventions","text":"<p>A consistent naming convention is used to identify devices and interfaces easily.</p> <p>Format: <code>[ROLE][INDEX].[DOMAIN]</code></p> <ul> <li>Roles:<ul> <li><code>FW</code>: Firewall / Router (e.g., <code>FW01</code>)</li> <li><code>ALS</code>: Access Layer Switch (e.g., <code>ALS01</code>)</li> <li><code>DLS</code>: Distribution Layer Switch (e.g., <code>DLS01</code>)</li> <li><code>AP</code>: Access Point (e.g., <code>AP01</code>)</li> <li><code>SRV</code>: Server (e.g., <code>SRV01</code>)</li> </ul> </li> <li>Domain: <code>lab.internal.packetflow.be</code></li> </ul> <p>Interface Naming: - VLANs: <code>VLAN[ID]</code> (e.g., <code>VLAN10</code>) - L3 Interfaces: Interactive names (e.g., <code>wan</code>, <code>lan</code>, <code>dmz</code>)</p>"},{"location":"01_network/02_logical/#4-logical-topology","title":"4. Logical Topology","text":"<p>(Layer 2 and Layer 3 diagrams showing VLANs, Trunks, and Routing paths)</p> <p>[Image Placeholder: Logical Topology Diagram]</p>"},{"location":"01_network/02_logical/#5-ip-addressing-scheme","title":"5. IP Addressing Scheme","text":""},{"location":"01_network/02_logical/#51-supernets","title":"5.1. Supernets","text":"Supernet Name Description <code>10.0.0.0/8</code> PacketFlow Global Supernet <code>10.10.0.0/16</code> Home Office Primary Site (Lab &amp; Residence) <code>10.20.0.0/16</code> Branch Office Remote Site"},{"location":"01_network/02_logical/#52-vlans-subnets","title":"5.2. VLANs &amp; Subnets","text":"VLAN ID Name IPv4 Subnet IPv6 Subnet (ULA) Gateway Description 10 <code>Home</code> <code>10.10.10.0/24</code> <code>fdb1:6575:ad8a:10::/64</code> <code>.1</code> Default Trusted Network. \"Office\" devices. 20 <code>Guest</code> <code>10.10.20.0/24</code> <code>fdb1:6575:ad8a:20::/64</code> <code>.1</code> Guest Network. Isolated Internet access only. 30 <code>Servers</code> <code>10.10.30.0/24</code> <code>fdb1:6575:ad8a:30::/64</code> <code>.1</code> Servers. Docker, VMs, Pis. 35 <code>DMZ</code> <code>10.10.35.0/24</code> <code>fdb1:6575:ad8a:35::/64</code> <code>.1</code> DMZ. Public facing services (e.g., HAProxy). 99 <code>MGMT</code> <code>10.10.99.0/24</code> <code>fdb1:6575:ad8a:99::/64</code> <code>.1</code> Management. Network device management. 666 <code>Blackhole</code> N/A N/A N/A Dead VLAN. Used for Native VLAN security. <p>Note: IPv6 Local Link addresses for Gateways are manually set to <code>fe80::[VLAN_ID]:1</code> for consistency.</p>"},{"location":"01_network/02_logical/#6-routing-wan","title":"6. Routing &amp; WAN","text":""},{"location":"01_network/02_logical/#61-routing-protocols","title":"6.1. Routing Protocols","text":"<ul> <li>IGP: Currently using Connected and Static routing. OSPF/BGP planned for future Branch Office integration.</li> <li>Default Route: <code>0.0.0.0/0</code> pointed to ISP Gateway via PPPoE/DHCP.</li> </ul>"},{"location":"01_network/02_logical/#62-sd-wan","title":"6.2. SD-WAN","text":"<ul> <li>Interface: <code>virtual-wan-link</code></li> <li>Members: <code>wan1</code> (ISP Uplink)</li> <li>Strategy: Even with a single uplink, SD-WAN is used to abstract policies.</li> <li>Rules:<ul> <li>Source IP load balancing (default).</li> <li><code>0.0.0.0/0</code> -&gt; <code>virtual-wan-link</code>.</li> </ul> </li> </ul>"},{"location":"01_network/02_logical/#63-inter-vlan-routing","title":"6.3. Inter-VLAN Routing","text":"<ul> <li>Performed by FortiGate 40F.</li> <li>Policy: Default Deny. Traffic must be explicitly allowed via Firewall Policies.</li> </ul>"},{"location":"01_network/03_device_decisions/","title":"Basic Device Decisions","text":""},{"location":"01_network/03_device_decisions/#1-design-rationale","title":"1. Design Rationale","text":"<p>The core principles driving device configuration are: 1.  Automation Friendly: Configurations should be standardized to allow for future automation (e.g., Ansible/Terraform). 2.  Security by Default: Deny-all policies, minimal open ports, and strict VLAN segmentation. 3.  Consistency: Naming conventions and IP schemes must be identical across devices and sites.</p>"},{"location":"01_network/03_device_decisions/#2-software-standards","title":"2. Software Standards","text":"<p>To ensure stability and feature compatibility, the following software versions are targeted:</p> Device Software Target Version Update Policy FortiGate 40F FortiOS 7.2.x (Mature) Manual update after backing up config. EdgeSwitch EdgeSwitch Firmware Latest Stable As needed for security patches. MikroTik hAP RouterOS v7.x (Stable) Auto-update disabled; manual review required."},{"location":"01_network/03_device_decisions/#3-configuration-standards","title":"3. Configuration Standards","text":""},{"location":"01_network/03_device_decisions/#31-interface-configuration-fortigate","title":"3.1. Interface Configuration (FortiGate)","text":"<p>Interfaces follow a strict template for IPv4 and IPv6 dual-stack connectivity.</p> Example: config of VLAN 10<pre><code>config system interface\n    edit \"VLAN10\"\n        set vdom \"root\"\n        set ip 10.10.10.1 255.255.255.0\n        set allowaccess ping\n        set alias \"VLAN Default\"\n        set device-identification enable\n        set role lan\n        set snmp-index 12\n        set ip-managed-by-fortiipam disable\n        config ipv6\n            set ip6-address fdb1:6575:ad8a:10::1/64\n            set ip6-allowaccess ping\n            config ip6-extra-addr\n                edit fe80::10:1/64 #(1)!\n                next\n            end\n            set ip6-send-adv enable\n            set ip6-other-flag enable #(2)!\n            config ip6-prefix-list\n                edit fdb1:6575:ad8a:10::/64\n                next\n            end\n        end\n        set interface \"mgmt\"\n        set vlanid 10\n    next\nend\n</code></pre> <ol> <li>Link Local Address: Manually set to <code>fe80::[VLAN_ID]:1</code> for consistency and ease of future troubleshooting.</li> <li>Other Flag: This flag is set to pass extra information to the clients, such as DNS servers and domain names. (not configured yet)</li> </ol>"},{"location":"01_network/03_device_decisions/#32-switching-logic-ubiquiti-edgeswitch","title":"3.2. Switching Logic (Ubiquiti EdgeSwitch)","text":"<ul> <li>VLANs: Must be defined in the VLAN database.</li> <li>Trunking: Uplinks are tagged for all active VLANs.</li> <li>Native VLAN: Unused ports and Trunks use <code>VLAN 666</code> (Blackhole) as Native to prevent VLAN hopping.</li> <li>Spanning Tree: RSTP enabled globally.</li> </ul>"},{"location":"01_network/03_device_decisions/#33-wireless-logic-mikrotik","title":"3.3. Wireless Logic (MikroTik)","text":"<ul> <li>Mode: Bridge AP with VLAN filtering.</li> <li>SSID Mapping: SSIDs are mapped to specific VLANs at the bridge ingress.</li> <li>Management: In-band management on VLAN 99.</li> </ul>"},{"location":"01_network/03_device_decisions/#4-security-wireless-decisions","title":"4. Security &amp; Wireless Decisions","text":""},{"location":"01_network/03_device_decisions/#41-security-strategy","title":"4.1. Security Strategy","text":"<ul> <li>Zone-Based Firewalling: Traffic is grouped into zones (LAN, Guest, Server, DMZ) to simplify policy management.</li> <li>Implicit Deny: The final rule in the policy set is always a DENY ALL.</li> <li>Deep Dive: See 04_security.md for detailed firewall policies and logic.</li> </ul>"},{"location":"01_network/03_device_decisions/#42-wireless-strategy","title":"4.2. Wireless Strategy","text":"<ul> <li>Frequency Planning: 2.4GHz for legacy/IoT, 5GHz for high-speed clients.</li> <li>Guest Access: Isolated on VLAN 20 with no access to internal RFC1918 ranges.</li> <li>Deep Dive: See 06_wireless.md for radio tuning and SSID details.</li> </ul>"},{"location":"01_network/04_security/","title":"Security &amp; Policies","text":""},{"location":"01_network/04_security/#1-overview","title":"1. Overview","text":"<p>The FortiGate 40F acts as a stateful firewall. The security posture follows zone-based approach; Traffic is grouped by source interface/VLAN to simplify policy management. I'm also using an implicit deny rule at the end of the policy list.  </p>"},{"location":"01_network/04_security/#2-firewall-zones-will-not-be-used","title":"2. Firewall Zones (will not be used)","text":"<p>will not be used</p> <p>Due to the VLANs already being used in the hardware switch, i can't add them to zones. I might look into this again, or just redo the whole fortigate setup later for a firewall-focused lab.</p> <ul> <li>LAN_Trusted: VLAN 10 (Default)  </li> <li>LAN_Guest: VLAN 20 (Guest)  </li> <li>SRV_Servers: VLAN 30 (Servers)  </li> <li>SRV_DMZ: VLAN 35 (DMZ)  </li> <li>WAN_Internet: WAN (Internet)  </li> <li>LAN_MGMT: VLAN 99 (Management), INT03 (Emergency)  </li> </ul> <p>I only have 2 Linux servers and no printers (yet).</p> <p>I'm currently running 2 linux servers (grafana and netbox, neither are DMZ) A future server for the DMZ will be my HAProxy An IOT VLAN will follow as well with printers (VLAN31 IOT) which will get it's own zone.</p>"},{"location":"01_network/04_security/#3-firewall-policies","title":"3. Firewall Policies","text":"<p>The following policies are currently active on the FortiGate:</p> Name From To Source Destination Action NAT Services Notes <code>Allow default VLAN to BSI and mail</code> VLAN 10 <code>virtual-wan-link</code> (4)VLAN10 address (4)all ACCEPT Enabled ICMP, HTTP/S, Email, ScreenConnect General internet access for users. <code>Allow guest VLAN to BSI and mail</code> VLAN 20 <code>virtual-wan-link</code> (4)VLAN20 address (4)all ACCEPT Enabled ALL_ICMP, HTTP/S, Email General internet access for guests. <code>Allow mgmt to internet with NAT</code> VLAN 99 <code>virtual-wan-link</code> (4)VLAN99 address (4)all ACCEPT Enabled ALL Unrestricted admin access. <code>Allow mgmt to everywhere</code> VLAN 99 ANY (4)VLAN99 address (4)all ACCEPT Disabled ALL Unrestricted admin access. <code>Allow emergency internet access</code> INT03 <code>virtual-wan-link</code> (4)all (4)all ACCEPT Enabled ALL Emergency internet access. <code>Allow emergency to everywhere</code> INT03 <code>down (mgmt)</code> ACCEPT Disabled ALL Emergency router access."},{"location":"01_network/04_security/#4-security-profiles","title":"4. Security Profiles","text":"<ul> <li>SSL Inspection: Default <code>certificate-inspection</code> (no decryption) is applied to most basic policies.</li> <li>Deep Packet Inspection: Not currently enforced globally to preserve privacy/performance on the 40F.</li> </ul>"},{"location":"01_network/06_wireless/","title":"Wireless Configuration","text":""},{"location":"01_network/06_wireless/#1-overview","title":"1. Overview","text":"<p>Wireless connectivity is provided by a MikroTik HAP ac Lite that I had laying around. The WiFi logic is separate from the routing core (FortiGate), operating in \"Bridge AP\" mode.  </p>"},{"location":"01_network/06_wireless/#2-access-points","title":"2. Access Points","text":"Device Model Location Management IP AP01 MikroTik hAP ac lite Central <code>10.10.99.x</code> (DHCP)"},{"location":"01_network/06_wireless/#3-ssids-frequency-planning","title":"3. SSIDs &amp; Frequency Planning","text":"SSID Band Frequency Channel Width Target VLAN Usage Declerck-Cardon 5 GHz Auto 40 MHz 20 (Guest) Any guest clients"},{"location":"01_network/06_wireless/#4-security-decisions","title":"4. Security Decisions","text":"<ul> <li>Authentication: WPA2-PSK (AES-CCMP).</li> <li>Key: A random password given to guests.</li> <li>Isolation: Client-to-Client forwarding is allowed by default on the AP Bridge, but Inter-VLAN traffic is blocked by the Firewall.</li> </ul>"},{"location":"01_network/06_wireless/#5-implementation-logic-mikrotik","title":"5. Implementation Logic (MikroTik)","text":"<p>The generic MikroTik implementation places all wireless clients into a specific VLAN tag at the AP ingress. - PVID/VLAN Mapping: <code>wlan1</code> and <code>wlan2</code> interfaces are set with PVID=20. - Bridge Filtering: The bridge tags frames from these interfaces with VLAN 20 before sending them up the trunk to the Core Switch.</p>"}]}